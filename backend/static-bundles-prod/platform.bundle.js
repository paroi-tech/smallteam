!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";function o(e){if(!e)return e;if("Map"===e[Symbol.toStringTag]){const t=["MAP"];for(let[n,i]of e)!i||"Map"!==i[Symbol.toStringTag]&&"Set"!==i[Symbol.toStringTag]||(i=o(i)),t.push([n,i]);return t}{const t=["SET"];for(let n of e.values())!n||"Map"!==n[Symbol.toStringTag]&&"Set"!==n[Symbol.toStringTag]||(n=o(n)),t.push(n);return t}}Object.defineProperty(t,"__esModule",{value:!0}),t.whyUsernameIsInvalid=t.whyTeamSubdomainIsInvalid=t.whyNewPasswordIsInvalid=t.toTitleCase=t.toDebugObj=t.toDebugStr=void 0,t.toDebugStr=function(e){return JSON.stringify(o(e),null,2)},t.toDebugObj=o,t.toTitleCase=function(e){return e.replace(/\w+/g,e=>e.charAt(0).toLocaleUpperCase()+e.substr(1))},t.whyNewPasswordIsInvalid=function(e){if(e.length<8)return"A password must have at least 8 characters"},t.whyTeamSubdomainIsInvalid=function(e){return e.length<2||e.length>16?"A team subdomain must have at least 2 characters and 16 characters at most":/^[0-9a-zA-Z]+(-[0-9a-zA-Z]+)*$/.test(e)?void 0:"A subdomain should only contains alphanumeric characters and dash and should not begin or end with dash."},t.whyUsernameIsInvalid=function(e){return e.length<1?"A username should have at least one character.":/\W/.test(e)?"A username can contain only letters, digits and underscore.":void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,...t){throw new Error('Configure the webpack loader or use "handledom/browser"')}},function(e,t,n){e.exports=n(9)},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";function o(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function i(e){return"string"==typeof e?[e]:e}function s(e){return 1===e.length&&Array.isArray(e[0])?e[0]:e}n.r(t);class a{constructor(e,t){this.app=e,this.componentId=t,this.map=new Map}invokeOrder(e,t){for(let n of i(e))this.exec(n,t);let n=this.app.getChildrenOf(this.componentId);for(let o of n)o.getDOrders().invokeOrder(e,t)}listenToDescendingOrder(e,t,n=null){for(let o of i(e)){let e=this.map.get(o);e||this.map.set(o,e=[]),e.push({cb:t,thisArg:n})}}stopListeningDescendingOrder(e,t,n=null){for(let o of i(e)){let e=this.map.get(o);e&&this.map.set(o,e.filter(e=>e.cb!==t||e.thisArg!==n))}}exec(e,t){let n=this.map.get(e);n&&n.forEach(e=>function(e,t){e.thisArg?e.cb.call(e.thisArg,t):e.cb(t)}(e,t))}}function r(e,t){e.thisArg?e.cb.call(e.thisArg,t.data,t):e.cb(t.data,t)}class l{constructor(e,t){this.log=e,this.eventNames=new Set,this.strictEvents=!1,this.destroyed=!1,t&&this.exposeEvent(t,!1)}exposeEvent(e,t){if(this.destroyed)throw new Error("Cannot call exposeEvent in a destroyed transmitter");for(let t of e)this.eventNames.add(t);t&&(this.strictEvents=!0)}emit(e){if(this.destroyed||!this.listeners)return;if(this.strictEvents&&!this.eventNames.has(e.eventName))throw new Error("Unexposed event: "+e.eventName);let t=this.listeners.get(e.eventName);if(t)for(let n of t)try{r(n,e)}catch(e){this.log.error(e)}}on(e,t,n){if(!this.destroyed){this.listeners||(this.listeners=new Map);for(let o of e){let e=this.listeners.get(o);e||this.listeners.set(o,e=[]),e.push({cb:t,thisArg:n})}}}off(e,t,n){if(!this.destroyed&&this.listeners)for(let[o,i]of this.listeners)if(!e||e.has(o))for(let e=0;e<i.length;++e){let o=i[e];o.cb===t&&o.thisArg===n&&(i.splice(e,1),--e)}}destroy(){this.listeners=void 0,this.destroyed=!0}}class d{listenTo(e,t,n,o=null){e.on(t,n,o),this.map||(this.map=new Map);let i=this.map.get(n);i||this.map.set(n,i=new Map);let s=i.get(o);s||i.set(o,s=new Map);let a=s.get(e);a||s.set(e,a=new Set);for(let e of t)a.add(e)}stopListeningEverywhere(e,t=null){if(!this.map)return;let n=this.map.get(e);if(!n)return;let o=n.get(t);if(o){for(let[n,i]of o)n.off(i,e,t);n.delete(t),0===n.size&&this.map.delete(e)}}stopListening(e,t,n,o=null){if(!this.map)return;let i=this.map.get(n);if(!i)return;let s=i.get(o);if(!s)return;let a=s.get(e);if(!a)return;let r=new Set;for(let e of t)a.delete(e)&&r.add(e);e.off(r,n,o),0===a.size&&(s.delete(e),0===s.size&&(i.delete(o),0===i.size&&this.map.delete(n)))}destroy(){if(this.map){for(let[e,t]of this.map)for(let[n,o]of t)for(let[t,i]of o)t.off(i,e,n);this.map=void 0}}}const c=Symbol("canPropagate");class h{constructor(e,t){var n;this.app=e,this.componentId=t,this.subscriber=new d,this.emitter=new l(e.log,["destroy"]),this.pub=(n=this,Object.freeze({unmanagedListeners:Object.freeze({on:(e,t,o)=>{n.emitter.on(i(e),t,o)},off:(e,t,o)=>{n.emitter.off(new Set(i(e)),t,o)}}),getComponent:()=>n.getInstance(),children:(e={})=>n.getChildren(e),hasChildren:(e={})=>n.hasChildren(e),isChild:e=>n.isChild(e),destroy:()=>n.destroy(),invokeDescendingOrder(e,t){return n.getDOrders().invokeOrder(e,t),this},isComponent:e=>n.app.isComponent(e),getPublicDashOf:e=>n.app.getBkbByInst(e).pub,getParentOf(e){let t=n.app.getBkbByInst(e).getParent();return t?t.getInstance():void 0},log:n.app.log,get app(){return n.app.root.getInstance()}})),this.dash=function(e,t){let n={setInstance:t=>(e.setInstance(t),o),exposeEvent:(...t)=>(e.emitter.exposeEvent(s(t),!0),o),create:(t,n)=>e.createChild({asObj:!1,Class:t,opt:n}).getInstance(),registerComponent:t=>e.createChild({asObj:!0,obj:t}).dash,addToGroup:(t,...n)=>(e.addToGroup(t,s(n)),o),inGroup:(t,...n)=>e.inGroup(t,s(n)),emit(t,n,i){let s=Array.isArray(t)?t:[t];for(let t of s)e.emit(t,n,i);return o},broadcast:(t,n)=>(e.broadcast(t,n),o),listenTo:(...t)=>{let n,s,a,r;if(2===t.length||"string"==typeof t[0]||Array.isArray(t[0]))[s,a,r]=t,n=e;else{let o;[o,s,a,r]=t,n=e.app.getBkbByInst(o)}return e.subscriber.listenTo(n.emitter,i(s),a,r),o},stopListening:(...t)=>{let n,s,a,r,l=t.length;if("string"==typeof t[0]||Array.isArray(t[0]))[s,a,r]=t,n=e;else{if(1===l||2===l)return[a,r]=t,void e.subscriber.stopListeningEverywhere(a,r);{let o;[o,s,a,r]=t,n=e.app.getBkbByInst(o)}}return e.subscriber.stopListening(n.emitter,i(s),a,r),o},listenToDescendingOrder:(t,n,i)=>(e.getDOrders().listenToDescendingOrder(t,n,i),o),stopListeningDescendingOrder:(t,n,i)=>(e.getDOrders().stopListeningDescendingOrder(t,n,i),o),destroyChildren:(t={})=>(e.destroyChildren(t),o),publicDash:t},o=Object.assign(Object.create(t),n);return Object.assign(o,...e.app.augmentList.map(e=>e(o))),e.app.root&&e.app.root!==e||(o.addDashAugmentation=t=>{e.app.augmentList.push(t)}),Object.freeze(o),o}(this,this.pub)}makeInstance(e,t){if(this.inst)return;let n;try{n=new e(this.dash,t)}catch(e){throw this.destroy(),e}this.setInstance(n)}setInstance(e){if(!this.pub)throw new Error("Destroyed component");if(this.inst){if(e!==this.inst)throw new Error("Conflict between component instances")}else this.inst=e,this.app.setInstanceOf(this.componentId,this.inst)}getInstance(){if(!this.inst){if(this.pub)throw new Error("The component instance is still not initialized");throw new Error("Destroyed component")}return this.inst}destroy(){this.emit("destroy",void 0,{sync:!0,cancelPropagation:!0}),this.app.removeComponent(this,this.inst),this.childGroups&&this.childGroups.clear(),this.emitter.destroy(),this.subscriber.destroy(),this.pub=void 0,this.dash=void 0,this.inst=void 0}forgetChild(e){if(this.childGroups)for(let t of this.childGroups.values())t.delete(e)}createChild(e){return this.app.createComponent(e,this)}addToGroup(e,t){let n=this.app.getBkbByInst(e).componentId;if(this!==this.app.getParentOf(n))throw new Error(`The component ${n} is not a child of ${this.componentId}`);this.childGroups||(this.childGroups=new Map);for(let e of t){let t=this.childGroups.get(e);t||this.childGroups.set(e,t=new Set),t.add(n)}}inGroup(e,t){if(!this.childGroups)return!1;let n=this.app.getBkbByInst(e).componentId;for(let e of t){let t=this.childGroups.get(e);if(t&&t.has(n))return!0}return!1}broadcast(e,t={}){t.sync?this.emitter.emit(e):this.app.asyncCall(()=>this.emitter.emit(e))}emit(e,t,n={}){n.sync?this.emitSync(this.createEvent(e,t,n.cancelPropagation)):this.app.asyncCall(()=>this.emitSync(this.createEvent(e,t,n.cancelPropagation)))}getParent(){return this.app.getParentOf(this.componentId)}getParents(){let e=this,t=[];for(;e=this.app.getParentOf(e.componentId);)t.push(e);return t}getChildren(e){let t=this.getChildBkbs(e.group),n=[];for(let o of t)!o.inst||e.filter&&!e.filter(o)||n.push(o.inst);return n}hasChildren(e){return this.getChildren(e).length>0}isChild(e){let t=this.app.getBkbByInst(e).componentId;return this===this.app.getParentOf(t)}destroyChildren(e){let t=this.getChildBkbs(e.group);for(let n of t)e.filter&&!e.filter(n)||n.destroy()}getDOrders(){return this.dOrders||(this.dOrders=new a(this.app,this.componentId)),this.dOrders}createEvent(e,t,n){let o=this,i=!n;return Object.freeze({eventName:e,get source(){return o.getInstance()},data:t,stopPropagation:()=>{i=!1},[c]:()=>i})}emitSync(e){if(this.emitter.emit(e),e[c]&&e[c]()){let t=this.app.getParentOf(this.componentId);t&&t.emitSync(e)}}getChildBkbs(e){if(!e)return this.app.getChildrenOf(this.componentId);if(!this.childGroups)return[];let t="string"==typeof e?[e]:e,n=new Set;for(let e of t){let t=this.childGroups.get(e);if(t)for(let e of t.values())n.add(e)}let o=[];for(let e of n.values())o.push(this.app.getBkb(e));return o}}class u{constructor(e,t,n){this.augmentList=[],this.compCount=0,this.nodesByInst=new WeakMap,this.nodes=new Map,this.insideRmComp=!1;let o=this.newId();this.log=this.createLog(["error","warn","info","debug","trace"]),this.root=new h(this,o);let i={bkb:this.root};this.nodes.set(o,i),this.root.emitter.exposeEvent(["log","addComponent","removeComponent","changeComponent"],!1),t?this.root.setInstance(e):this.root.makeInstance(e,n),i.created=!0}setInstanceOf(e,t){let n=this.nodes.get(e);if(!n)throw new Error("Destroyed component");this.nodesByInst.set(t,n)}getParentOf(e){let t=this.findNode(e);return t.parent?t.parent.bkb:void 0}getChildrenOf(e){let t=[],n=this.findNode(e).children;if(n)for(let e of n.values())t.push(e.bkb);return t}getBkb(e){return this.findNode(e).bkb}getBkbByInst(e){return this.findNodeByInst(e).bkb}isComponent(e){return!!this.nodesByInst.get(e)}createComponent(e,t){if(!this.root.dash)throw new Error("Destroyed root component");let n=this.newId(),o=new h(this,n),i=this.findNode(t.componentId),s={bkb:o,parent:i};return this.nodes.set(n,s),i.children||(i.children=new Map),i.children.set(n,s),e.asObj?o.setInstance(e.obj):o.makeInstance(e.Class,e.opt),this.root.dash.emit(["addComponent","changeComponent"],{component:o.getInstance(),type:"add"}),s.created=!0,o}removeComponent(e,t){if(!this.root.dash)throw new Error("Destroyed root component");let n=!this.insideRmComp;try{let o=e.componentId,i=this.findNode(o);if(n&&(this.insideRmComp=!0,t&&i.created)){let e={component:t,type:"remove"};this.root.dash.emit(["removeComponent","changeComponent"],e,{sync:!0})}if(i.children){for(let e of i.children.values())e.parent=void 0,e.bkb.destroy();i.children.clear()}i.parent&&(i.parent.bkb.forgetChild(o),i.parent.children.delete(o)),this.nodes.delete(o),t&&this.nodesByInst.delete(t)}finally{n&&(this.insideRmComp=!1)}}asyncCall(e){this.tickList?this.tickList.push(e):(this.tickList=[e],setTimeout(()=>{if(this.tickList){for(let e of this.tickList)try{e()}catch(e){this.log.error(e)}this.tickList=void 0}},0))}findNode(e){let t=this.nodes.get(e);if(!t)throw new Error(`Missing node of component "${e}"`);return t}findNodeByInst(e){let t=this.nodesByInst.get(e);if(!t)throw new Error("Cannot find a component for the instance: "+e);return t}newId(){return this.compCount++}createLog(e){let t={},n=0;for(let o of e)t[o]=(...e)=>{if(!this.root.dash)throw new Error("Destroyed root component");this.root.dash.emit("log",{level:o,messages:e,levelNumber:++n},{sync:!0})};return Object.freeze(t)}}var p=n(0),m=window.CustomEvent;function f(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement}return null}function g(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function b(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1}function v(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function E(e){return e.isConnected||document.body.contains(e)}function y(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window){new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]})}else{var t,n=!1,o=function(){n?this.downgradeModal():this.maybeHideModal(),n=!1}.bind(this),i=function(i){if(i.target===e){var s="DOMNodeRemoved";n|=i.type.substr(0,s.length)===s,window.clearTimeout(t),t=window.setTimeout(o,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,i)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}m&&"object"!=typeof m||((m=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),n}).prototype=window.Event.prototype),y.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&E(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),w.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var n=document.createEvent("MouseEvents");n.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(n),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=function e(t){var n=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));n.push('[tabindex]:not([disabled]):not([tabindex=""])');var o=t.querySelector(n.join(", "));if(!o&&"attachShadow"in Element.prototype)for(var i=t.querySelectorAll("*"),s=0;s<i.length&&!(i[s].tagName&&i[s].shadowRoot&&(o=e(i[s].shadowRoot)));s++);return o}(this.dialog_)),g(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!E(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!w.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),n=function(e,n){return!(void 0===t[e]||t[e]===n)};if(t.opacity<1||n("zIndex","auto")||n("transform","none")||n("mixBlendMode","normal")||n("filter","none")||n("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,w.needsCentering(this.dialog_)?(w.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var t=new m("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(t)}};var w={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,n=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,n)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var n=document.styleSheets[t],o=null;try{o=n.cssRules}catch(e){}if(o)for(var i=0;i<o.length;++i){var s=o[i],a=null;try{a=document.querySelectorAll(s.selectorText)}catch(e){}if(a&&b(a,e)){var r=s.style.getPropertyValue("top"),l=s.style.getPropertyValue("bottom");if(r&&"auto"!==r||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return"absolute"===window.getComputedStyle(e).position&&(!("auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom)&&!w.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new y(e)},registerDialog:function(e){e.showModal||w.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var n=[];t.forEach((function(e){for(var t,o=0;t=e.removedNodes[o];++o)t instanceof Element&&("dialog"===t.localName&&n.push(t),n=n.concat(t.querySelectorAll("dialog")))})),n.length&&e(n)})))}};if(w.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},w.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},w.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,n=0;e=this.pendingDialogStack[n];++n)e.updateZIndex(--t,--t),0===n&&(this.overlay.style.zIndex=--t);var o=this.pendingDialogStack[0];o?(o.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},w.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=f(e);){for(var t,n=0;t=this.pendingDialogStack[n];++n)if(t.dialog===e)return 0===n;e=e.parentElement}return!1},w.DialogManager.prototype.handleFocus_=function(e){if(!this.containedByTopDialog_(e.target)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),g(e.target),void 0!==this.forwardTab_)){var t=this.pendingDialogStack[0];return t.dialog.compareDocumentPosition(e.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?t.focus_():e.target!==document.documentElement&&document.documentElement.focus()),!1}},w.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var t=new m("cancel",{bubbles:!1,cancelable:!0}),n=this.pendingDialogStack[0];n&&n.dialog.dispatchEvent(t)&&n.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},w.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},w.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t)&&(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),!0)},w.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},w.dm=new w.DialogManager,w.formSubmitter=null,w.useValue=null,void 0===window.HTMLDialogElement){var C=document.createElement("form");if(C.setAttribute("method","dialog"),"dialog"!==C.method){var D=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(D){var A=D.get;D.get=function(){return v(this)?"dialog":A.call(this)};var k=D.set;D.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):k.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",D)}}document.addEventListener("click",(function(e){if(w.formSubmitter=null,w.useValue=null,!e.defaultPrevented){var t=e.target;if(t&&v(t.form)){if(!("submit"===t.type&&["button","input"].indexOf(t.localName)>-1)){if("input"!==t.localName||"image"!==t.type)return;w.useValue=e.offsetX+","+e.offsetY}f(t)&&(w.formSubmitter=t)}}}),!1);var M=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!v(this))return M.call(this);var e=f(this);e&&e.close()},document.addEventListener("submit",(function(e){if(!e.defaultPrevented){var t=e.target;if(v(t)){e.preventDefault();var n=f(t);if(n){var o=w.formSubmitter;o&&o.form===t?n.close(w.useValue||o.value):n.close(),w.formSubmitter=null}}}}),!1)}var T=w;n(1);class S{constructor(){this.promise=new Promise((e,t)=>{this.resolveCb=e,this.rejectCb=t})}pipeTo(e){return e.then(e=>this.resolve(e),e=>this.reject(e)),this.promise}resolve(e){this.resolveCb(e)}reject(e){this.rejectCb(e)}}n(4);class I{constructor(e){this.dash=e;const{root:t,ref:n}=function(){const e=document.createElement("dialog");e.setAttribute("class","ErrorDialog ModalDialog");const t=document.createElement("header");e.appendChild(t),t.setAttribute("class","ModalDialog-header");const n=document.createElement("div");e.appendChild(n),n.setAttribute("class","ModalDialog-content");const o=document.createElement("div");e.appendChild(o),o.setAttribute("class","ModalDialog-bottom");const i=document.createElement("div");t.appendChild(i),i.setAttribute("class","ModalDialog-headerLeft");const s=document.createElement("div");t.appendChild(s),s.setAttribute("class","ModalDialog-headerRight");const a=document.createElement("div");n.appendChild(a),a.setAttribute("class","ModalDialog-contentLeft ErrorDialog-contentLeft");const r=document.createElement("div");n.appendChild(r),r.setAttribute("class","ModalDialog-contentRight");const l=document.createElement("button");o.appendChild(l),l.setAttribute("class","ModalDialogOkButton");const d=document.createElement("span");i.appendChild(d);const c=document.createElement("span");s.appendChild(c),c.setAttribute("class","fas fa-times fa-1x ModalDialogCloseItem");const h=document.createElement("span");a.appendChild(h),h.setAttribute("class","fas fa-3x fa-exclamation-circle");const u=document.createElement("div");r.appendChild(u);const p=document.createTextNode("OK");l.appendChild(p);const m={button:l,title:d,close:c,message:u};return{root:e,refs:m,ref:e=>{if(!m[e])throw new Error(`Missing handle: '${e}'`);return m[e]},update:()=>{}}}();this.el=t,this.msgEl=n("message"),this.titleEl=n("title"),T.registerDialog(this.el);const o=()=>this.close();n("button").addEventListener("click",o),n("close").addEventListener("click",o),this.el.addEventListener("cancel",e=>{e.preventDefault(),this.close()}),this.el.addEventListener("keydown",e=>{"Enter"===e.key&&this.close()})}show(e,t="Error"){this.currDfd=new S,this.titleEl.textContent=t,o(this.msgEl);const n="string"==typeof e?[e]:e;for(const e of n){const t=document.createElement("p");t.textContent=e,this.msgEl.appendChild(t)}return document.body.appendChild(this.el),this.el,this.el.showModal(),this.currDfd.promise}close(){this.currDfd&&this.currDfd.resolve(!0),this.currDfd=void 0,this.el.close(),document.body.removeChild(this.el)}}n(5);class _{constructor(e){this.dash=e;const{root:t,ref:n}=function(){const e=document.createElement("dialog");e.setAttribute("class","ModalDialog InfoDialog");const t=document.createElement("header");e.appendChild(t),t.setAttribute("class","ModalDialog-header");const n=document.createElement("div");e.appendChild(n),n.setAttribute("class","ModalDialog-content");const o=document.createElement("div");e.appendChild(o),o.setAttribute("class","ModalDialog-bottom");const i=document.createElement("div");t.appendChild(i),i.setAttribute("class","ModalDialog-headerLeft");const s=document.createElement("div");t.appendChild(s),s.setAttribute("class","ModalDialog-headerRight");const a=document.createElement("div");n.appendChild(a),a.setAttribute("class","ModalDialog-contentLeft InfoDialog-contentLeft");const r=document.createElement("div");n.appendChild(r),r.setAttribute("class","ModalDialog-contentRight");const l=document.createElement("button");o.appendChild(l),l.setAttribute("class","ModalDialogOkButton");const d=document.createElement("span");i.appendChild(d);const c=document.createElement("span");s.appendChild(c),c.setAttribute("class","fas fa-times fa-1x ModalDialogCloseItem");const h=document.createElement("span");a.appendChild(h),h.setAttribute("class","fas fa-3x fa-info-circle");const u=document.createElement("div");r.appendChild(u);const p=document.createTextNode("OK");l.appendChild(p);const m={button:l,title:d,close:c,message:u};return{root:e,refs:m,ref:e=>{if(!m[e])throw new Error(`Missing handle: '${e}'`);return m[e]},update:()=>{}}}();this.el=t,this.msgEl=n("message"),this.titleEl=n("title"),T.registerDialog(this.el);const o=()=>this.close();n("button").addEventListener("click",o),n("close").addEventListener("click",o),this.el.addEventListener("cancel",e=>{e.preventDefault(),this.close()}),this.el.addEventListener("keydown",e=>{"Enter"===e.key&&(e.stopPropagation(),this.close())})}show(e,t="Information"){this.currDfd=new S,this.titleEl.textContent=t,o(this.msgEl);const n="string"==typeof e?[e]:e;for(const e of n){const t=document.createElement("p");t.textContent=e,this.msgEl.appendChild(t)}return document.body.appendChild(this.el),this.el,this.el.showModal(),this.currDfd.promise}close(){this.currDfd&&this.currDfd.resolve(!0),this.currDfd=void 0,this.el.close(),document.body.removeChild(this.el)}}n(6);class O{constructor(e){this.dash=e;const{root:t,ref:n}=function(){const e=document.createElement("dialog");e.setAttribute("class","ModalDialog UncloseableDialog");const t=document.createElement("header");e.appendChild(t),t.setAttribute("class","ModalDialog-header");const n=document.createElement("div");e.appendChild(n),n.setAttribute("class","UncloseableDialog-content");const o=document.createElement("span");t.appendChild(o);const i={message:n,title:o};return{root:e,refs:i,ref:e=>{if(!i[e])throw new Error(`Missing handle: '${e}'`);return i[e]},update:()=>{}}}();this.el=t,this.msgEl=n("message"),this.titleEl=n("title"),T.registerDialog(this.el),this.el.addEventListener("cancel",e=>e.preventDefault())}show(e,t=""){this.titleEl.textContent=t,o(this.msgEl);const n="string"==typeof e?[e]:e;for(const e of n){const t=document.createElement("p");t.textContent=e,this.msgEl.appendChild(t)}document.body.appendChild(this.el),this.el.showModal()}close(){document.body.removeChild(this.el)}}n(7);class x{constructor(e){this.dash=e;const{root:t,ref:n}=function(){const e=document.createElement("dialog");e.setAttribute("class","ModalDialog WarningDialog");const t=document.createElement("header");e.appendChild(t),t.setAttribute("class","ModalDialog-header");const n=document.createElement("div");e.appendChild(n),n.setAttribute("class","ModalDialog-content");const o=document.createElement("div");e.appendChild(o),o.setAttribute("class","ModalDialog-bottom");const i=document.createElement("div");t.appendChild(i),i.setAttribute("class","ModalDialog-headerLeft");const s=document.createElement("div");t.appendChild(s),s.setAttribute("class","ModalDialog-headerRight");const a=document.createElement("div");n.appendChild(a),a.setAttribute("class","ModalDialog-contentLeft WarningDialog-contentLeft");const r=document.createElement("div");n.appendChild(r),r.setAttribute("class","ModalDialog-contentRight");const l=document.createElement("button");o.appendChild(l),l.setAttribute("class","ModalDialogOkButton");const d=document.createElement("span");i.appendChild(d);const c=document.createElement("span");s.appendChild(c),c.setAttribute("class","fas fa-times fa-lg ModalDialogCloseItem");const h=document.createElement("span");a.appendChild(h),h.setAttribute("class","fas fa-3x fa-exclamation-triangle");const u=document.createElement("div");r.appendChild(u);const p=document.createTextNode("OK");l.appendChild(p);const m={button:l,title:d,close:c,message:u};return{root:e,refs:m,ref:e=>{if(!m[e])throw new Error(`Missing handle: '${e}'`);return m[e]},update:()=>{}}}();this.el=t,this.msgEl=n("message"),this.titleEl=n("title"),T.registerDialog(this.el);const o=()=>this.close();n("button").addEventListener("click",o),n("close").addEventListener("click",o),this.el.addEventListener("cancel",e=>{e.preventDefault(),this.close()}),this.el.addEventListener("keydown",e=>{"Enter"===e.key&&this.close()})}show(e,t="Warning"){this.currDfd=new S,this.titleEl.textContent=t,o(this.msgEl);const n="string"==typeof e?[e]:e;for(const e of n){const t=document.createElement("p");t.textContent=e,this.msgEl.appendChild(t)}return document.body.appendChild(this.el),this.el,this.el.showModal(),this.currDfd.promise}close(){this.currDfd&&this.currDfd.resolve(!0),this.currDfd=void 0,this.el.close(),document.body.removeChild(this.el)}}n(8);class N{constructor(e){this.dash=e,this.canSetTeamName=!0,this.canSetName=!0,this.canSetLogin=!0;const{root:t,ref:n}=function(){const e=document.createElement("dialog");e.setAttribute("class","TeamCreationDialog");const t=document.createElement("header");e.appendChild(t),t.setAttribute("class","TeamCreationDialog-header Text");const n=document.createElement("div");e.appendChild(n),n.setAttribute("class","TeamCreationDialog-content");const o=document.createElement("h1");t.appendChild(o);const i=document.createElement("ol");t.appendChild(i);const s=document.createElement("p");t.appendChild(s);const a=document.createElement("div");n.appendChild(a),a.setAttribute("class","FieldGroup");const r=document.createElement("div");n.appendChild(r),r.setAttribute("class","FieldGroup");const l=document.createTextNode("SmallTeam Terms of Use");o.appendChild(l);const d=document.createElement("li");i.appendChild(d);const c=document.createElement("li");i.appendChild(c);const h=document.createElement("li");i.appendChild(h);const u=document.createElement("li");i.appendChild(u);const p=document.createElement("li");i.appendChild(p);const m=document.createElement("em");s.appendChild(m);const f=document.createElement("h1");a.appendChild(f),f.setAttribute("class","FieldGroup-title");const g=document.createElement("div");a.appendChild(g),g.setAttribute("class","FieldGroup-multiItem");const b=document.createElement("h1");r.appendChild(b),b.setAttribute("class","FieldGroup-title");const v=document.createElement("label");r.appendChild(v),v.setAttribute("class","FieldGroup-item Field");const E=document.createElement("div");r.appendChild(E),E.setAttribute("class","FieldGroup-multiItem");const y=document.createElement("label");r.appendChild(y),y.setAttribute("class","FieldGroup-item Field");const w=document.createElement("label");r.appendChild(w),w.setAttribute("class","FieldGroup-item Field");const C=document.createElement("div");r.appendChild(C);const D=document.createTextNode("This service is free.");d.appendChild(D);const A=document.createTextNode("Data from active teams will be provided to team administrators upon request, in the form of SQLite\n        databases.");c.appendChild(A);const k=document.createTextNode("Teams that have not been active for several months will be automatically destroyed.");h.appendChild(k);const M=document.createTextNode("Paroi reserves the right to change the conditions of access to the service at a later date.");u.appendChild(M);const T=document.createTextNode("SmallTeam software is open-source and will remain so.");p.appendChild(T);const S=document.createTextNode("Note: This service is not intended to remain free. Our goal is to provide a simple, lightweight software,\n      adapted to small connections, at a very low cost. We are not ready. In the meantime, teams who wish to do so are\n      invited to use the service for free, which will also help us to test its robustness.");m.appendChild(S);const I=document.createTextNode("Your team");f.appendChild(I);const _=document.createElement("label");g.appendChild(_),_.setAttribute("class","FieldGroup-item Field");const O=document.createElement("label");g.appendChild(O),O.setAttribute("class","FieldGroup-item Field");const x=document.createTextNode("Your account");b.appendChild(x);const N=document.createElement("span");v.appendChild(N),N.setAttribute("class","Field-lbl");const L=document.createElement("span");v.appendChild(L),L.setAttribute("class","Field-deco -leftBlue");const F=document.createElement("label");E.appendChild(F),F.setAttribute("class","FieldGroup-item Field");const P=document.createElement("label");E.appendChild(P),P.setAttribute("class","FieldGroup-item Field");const j=document.createElement("span");y.appendChild(j),j.setAttribute("class","Field-lbl");const B=document.createElement("span");y.appendChild(B),B.setAttribute("class","Field-deco -leftBlue");const G=document.createElement("span");w.appendChild(G),G.setAttribute("class","Field-lbl");const z=document.createElement("span");w.appendChild(z),z.setAttribute("class","Field-deco -leftBlue");const R=document.createElement("button");C.appendChild(R),R.setAttribute("class","FieldGroup-action Btn WithLoader -right"),R.setAttribute("type","button");const H=document.createTextNode("\n         \n        ");C.appendChild(H);const U=document.createElement("button");C.appendChild(U),U.setAttribute("class","Btn"),U.setAttribute("type","button");const W=document.createElement("span");_.appendChild(W),W.setAttribute("class","Field-lbl");const K=document.createElement("span");_.appendChild(K),K.setAttribute("class","Field-deco -leftBlue");const Z=document.createElement("span");O.appendChild(Z),Z.setAttribute("class","Field-lbl");const $=document.createElement("span");O.appendChild($),$.setAttribute("class","Field-deco -leftBlue");const q=document.createTextNode("Your email address");N.appendChild(q);const V=document.createElement("input");L.appendChild(V),V.setAttribute("class","Field-input"),V.setAttribute("type","email"),V.setAttribute("required",""),V.setAttribute("spellcheck","false");const Y=document.createElement("span");F.appendChild(Y),Y.setAttribute("class","Field-lbl");const J=document.createElement("span");F.appendChild(J),J.setAttribute("class","Field-deco -leftBlue");const X=document.createElement("span");P.appendChild(X),X.setAttribute("class","Field-lbl");const Q=document.createElement("span");P.appendChild(Q),Q.setAttribute("class","Field-deco -leftBlue");const ee=document.createTextNode("Password");j.appendChild(ee);const te=document.createElement("input");B.appendChild(te),te.setAttribute("class","Field-input"),te.setAttribute("type","password");const ne=document.createTextNode("Confirm your password");G.appendChild(ne);const oe=document.createElement("input");z.appendChild(oe),oe.setAttribute("class","Field-input"),oe.setAttribute("type","password");const ie=document.createTextNode("\n          Submit\n          ");R.appendChild(ie);const se=document.createElement("span");R.appendChild(se),se.setAttribute("class","WithLoader-l"),se.setAttribute("hidden","");const ae=document.createTextNode("Cancel");U.appendChild(ae);const re=document.createTextNode("Subdomain");W.appendChild(re);const le=document.createElement("input");K.appendChild(le),le.setAttribute("class","Field-input"),le.setAttribute("type","text"),le.setAttribute("pattern","^[a-z][a-z0-9]+"),le.setAttribute("spellcheck","false");const de=document.createTextNode("Team name");Z.appendChild(de);const ce=document.createElement("input");$.appendChild(ce),ce.setAttribute("class","Field-input"),ce.setAttribute("type","text"),ce.setAttribute("spellcheck","false");const he=document.createTextNode("Login");Y.appendChild(he);const ue=document.createElement("input");J.appendChild(ue),ue.setAttribute("class","Field-input"),ue.setAttribute("type","text"),ue.setAttribute("pattern","^[a-z][a-z0-9]+"),ue.setAttribute("spellcheck","false");const pe=document.createTextNode("Name");X.appendChild(pe);const me=document.createElement("input");Q.appendChild(me),me.setAttribute("class","Field-input"),me.setAttribute("type","text");const fe={submitBtn:R,cancelBtn:U,email:V,password:te,confirm:oe,spinner:se,subdomain:le,teamName:ce,login:ue,name:me};return{root:e,refs:fe,ref:e=>{if(!fe[e])throw new Error(`Missing handle: '${e}'`);return fe[e]},update:()=>{}}}();this.el=t,this.subdomainEl=n("subdomain"),this.teamNameEl=n("teamName"),this.emailEl=n("email"),this.loginEl=n("login"),this.nameEl=n("name"),this.passwordEl=n("password"),this.confirmEl=n("confirm"),T.registerDialog(this.el),n("submitBtn").addEventListener("click",()=>this.onSubmit()),n("cancelBtn").addEventListener("click",()=>{this.curDfd&&(this.curDfd.reject("Process canceled"),this.curDfd=void 0,this.el.close())}),this.subdomainEl.addEventListener("input",()=>{this.canSetTeamName&&(this.subdomainEl.validity.valid?this.teamNameEl.value=Object(p.toTitleCase)(this.subdomainEl.value):this.teamNameEl.value="")}),this.teamNameEl.addEventListener("oninput",()=>this.canSetTeamName=!1),this.emailEl.addEventListener("input",()=>{if(!this.canSetLogin&&!this.canSetName)return;if(!this.emailEl.validity.valid)return this.loginEl.value=this.canSetLogin?"":this.loginEl.value,void(this.nameEl.value=this.canSetName?"":this.nameEl.value);const e=this.emailEl.value.split("@")[0].toLocaleLowerCase(),t=e.replace(/\W/g,"_");this.canSetLogin&&!Object(p.whyUsernameIsInvalid)(t)&&(this.loginEl.value=t),this.canSetName&&(this.nameEl.value=Object(p.toTitleCase)(e.replace(/\./," ")))}),this.loginEl.addEventListener("input",()=>{this.canSetLogin=!1,this.canSetName&&this.loginEl.validity.valid&&(this.nameEl.value=Object(p.toTitleCase)(this.loginEl.value))}),this.nameEl.addEventListener("input",()=>this.canSetName=!1),this.el.addEventListener("cancel",e=>e.preventDefault())}async open(){return document.body.appendChild(this.el),this.el.showModal(),this.curDfd=new S,this.curDfd.promise}async onSubmit(){let e;const t=this.subdomainEl.value.trim();if(e=Object(p.whyTeamSubdomainIsInvalid)(t),e)return await this.dash.create(x).show(e),void this.teamNameEl.focus();const n=this.teamNameEl.value.trim();if(0===n.length)return await this.dash.create(x).show("Please enter a team name."),void this.teamNameEl.focus();const o=this.nameEl.value.trim();if(0===o.length)return await this.dash.create(x).show("Please enter a name for the user."),void this.teamNameEl.focus();const i=this.loginEl.value.trim();if(e=Object(p.whyUsernameIsInvalid)(i),e)return await this.dash.create(x).show(e),void this.loginEl.focus();const s=this.passwordEl.value;if(e=Object(p.whyNewPasswordIsInvalid)(s),e)return await this.dash.create(x).show(e),void this.passwordEl.focus();if(this.confirmEl.value!==s)return await this.dash.create(x).show("Passwords do not match."),void this.confirmEl.focus();const a=this.emailEl.value.trim();if(0===a.length||!function(e){return null!==/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.exec(e)}(a))return this.dash.create(x).show("Please enter a valid email address."),void this.emailEl.focus();const r=await this.checkSubdomain(t);if(r.done)return r.answer?void(await this.register(n,t,o,i,s,a)&&this.curDfd&&(this.curDfd.resolve(!0),this.curDfd=void 0,this.el.close())):(await this.dash.create(x).show("The subdomain you chosed is not available. Try another one."),void this.subdomainEl.focus());this.dash.create(x).show("Something went wrong. We could not contact server for the moment.")}async checkSubdomain(e){const t={done:!1,answer:!1};try{const n=await fetch(this.dash.app.baseUrl+"/api/team/check-subdomain",{method:"post",credentials:"same-origin",headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),body:JSON.stringify({subdomain:e})});n.ok&&(t.answer=(await n.json()).answer,t.done=!0)}catch(e){this.dash.log.error("Unable to get response from server",e)}return t}async register(e,t,n,o,i,s){try{const a=await fetch(this.dash.app.baseUrl+"/api/team/create",{method:"post",credentials:"same-origin",headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),body:JSON.stringify({teamName:e,subdomain:t,name:n,username:o,password:i,email:s})});if(!a.ok)return await this.dash.create(I).show("Something went wrong. We could not process your request."),!1;if((await a.json()).done)return this.dash.create(O).show(["Your team is registered.","You should get an email with a link to activate your account."]),!0;this.dash.create(I).show(["Something went wrong. We could not process your request.","Try again later."])}catch(e){this.dash.log.error(e),this.dash.create(_).show(["Something went wrong. We can't reach server.","Try again later."])}return!1}}class L{constructor(e,t={}){var n;this.dash=e,this.options=t,this.log=e.log,this.baseUrl=document.documentElement.dataset.baseUrl||"",this.teamDialog=this.dash.create(N);const o=null!==(n=document.documentElement.dataset.env)&&void 0!==n?n:"prod";this.dash.listenTo("log",e=>{console&&("local"!==o&&"error"!==e.level&&"warn"!==e.level||(console[e.level]?console[e.level](...e.messages):console.log(`[${e.level}]`,...e.messages)))})}start(){if((this.options.action||this.options.token)&&"register"!==this.options.action){if("activate"!==this.options.action)throw new Error("Unknown action parameter");this.activateTeam()}else this.showTeamCreationDialog()}async activateTeam(){if(!this.options.token)throw new Error("Token not found");try{const e=await fetch(this.baseUrl+"/api/team/activate",{method:"post",credentials:"same-origin",headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),body:JSON.stringify({token:this.options.token})});if(!e.ok)return void await this.dash.create(I).show("Cannot complete this task now. Try again in a moment.");const t=await e.json();if(!t.done)return void this.dash.create(I).show("Team activation failed.");document.location.href=""+t.teamUrl}catch(e){this.dash.create(_).show("Something went wrong. We cannot reach our server.")}}async showTeamCreationDialog(){await this.teamDialog.open()}}n(3),document.addEventListener("DOMContentLoaded",()=>{const e=new URL(window.location.href),t=e.searchParams.get("action")||void 0,n=e.searchParams.get("token")||void 0,i=document.querySelector(".js-app");i&&o(i),function(e,t){return new u(e,!1,t).root.getInstance()}(L,{action:t,token:n}).start()})}]);